---
jupyter:
  jupytext:
    cell_metadata_filter: all,-slideshow
    formats: ipynb,Rmd
    text_representation:
      extension: .Rmd
      format_name: rmarkdown
      format_version: '1.2'
      jupytext_version: 1.3.4
  kernelspec:
    display_name: Python 3
    language: python
    name: python3
---

```{python}
import pandas as pd, numpy as np
# %matplotlib inline
import matplotlib
matplotlib.rc('figure', figsize=(8,8))
```

```{python}
states = pd.read_csv('us-states.csv')
daily = states.groupby(by='date')
states.columns
```

## US deaths & cases

```{python}
totals = daily.sum()
```

```{python}
daily_deaths = np.asarray(totals['deaths']).copy()
daily_deaths[1:] = daily_deaths[1:] - daily_deaths[:-1]
totals.insert(3, 'daily_deaths', daily_deaths)
totals.plot.bar(y=['deaths', 'daily_deaths'], subplots=True)
```

```{python}
daily_cases = np.asarray(totals['cases']).copy()
daily_cases[1:] = daily_cases[1:] - daily_cases[:-1]
totals.insert(3, 'daily_cases', daily_cases)
totals.plot.bar(y=['cases', 'daily_cases'], subplots=True)
```

## Last few days

```{python}
totals[-3:]
```

## California deaths & cases

```{python}
cali = states.loc[lambda df: df['state'] == 'California']
```

```{python}
daily_ca_deaths = np.asarray(cali['deaths']).copy()
daily_ca_deaths[1:] = daily_ca_deaths[1:] - daily_ca_deaths[:-1]
cali.insert(3, 'daily_deaths', daily_ca_deaths)
cali.plot.bar(y=['deaths', 'daily_deaths'], x='date', subplots=True)
```

```{python lines_to_next_cell=0}
daily_ca_cases = np.asarray(cali['cases']).copy()
daily_ca_cases[1:] = daily_ca_cases[1:] - daily_ca_cases[:-1]
cali.insert(3, 'daily_cases', daily_ca_cases)
cali.plot.bar(y=['cases', 'daily_cases'], x='date', subplots=True)
```



## New York deaths & cases

```{python}
ny = states.loc[lambda df: df['state'] == 'New York']
ny.columns
```

```{python}
daily_ny_deaths = np.asarray(ny['deaths']).copy()
daily_ny_deaths[1:] = daily_ny_deaths[1:] - daily_ny_deaths[:-1]
ny.insert(3, 'daily_deaths', daily_ny_deaths)
ny.plot.bar(y=['deaths', 'daily_deaths'], x='date', subplots=True)
```

```{python}
daily_ny_cases = np.asarray(ny['cases']).copy()
daily_ny_cases[1:] = daily_ny_cases[1:] - daily_ny_cases[:-1]
ny.insert(3, 'daily_cases', daily_ny_cases)
ny.plot.bar(y=['cases', 'daily_cases'], x='date', subplots=True)
```

## Florida deaths & cases

```{python}
fl = states.loc[lambda df: df['state'] == 'Florida']
```

```{python}
daily_fl_deaths = np.asarray(fl['deaths']).copy()
daily_fl_deaths[1:] = daily_fl_deaths[1:] - daily_fl_deaths[:-1]
fl.insert(3, 'daily_deaths', daily_fl_deaths)
fl.plot.bar(y=['deaths', 'daily_deaths'], x='date', subplots=True)
```

```{python lines_to_next_cell=0}
daily_fl_cases = np.asarray(fl['cases']).copy()
daily_fl_cases[1:] = daily_fl_cases[1:] - daily_fl_cases[:-1]
fl.insert(3, 'daily_cases', daily_fl_cases)
fl.plot.bar(y=['cases', 'daily_cases'], subplots=True)
```
## Texas deaths & cases

```{python}
tx = states.loc[lambda df: df['state'] == 'Texas']
```

```{python}
daily_tx_deaths = np.asarray(tx['deaths']).copy()
daily_tx_deaths[1:] = daily_tx_deaths[1:] - daily_tx_deaths[:-1]
tx.insert(3, 'daily_deaths', daily_tx_deaths)
tx.plot.bar(y=['deaths', 'daily_deaths'], x='date', subplots=True)
```

```{python lines_to_next_cell=0}
daily_tx_cases = np.asarray(tx['cases']).copy()
daily_tx_cases[1:] = daily_tx_cases[1:] - daily_tx_cases[:-1]
tx.insert(3, 'daily_cases', daily_tx_cases)
tx.plot.bar(y=['cases', 'daily_cases'], subplots=True)
```
## Louisiana deaths & cases

```{python}
la = states.loc[lambda df: df['state'] == 'Louisiana']
daily_la_deaths = np.asarray(la['deaths']).copy()
daily_la_deaths[1:] = daily_la_deaths[1:] - daily_la_deaths[:-1]
la.insert(3, 'daily_deaths', daily_la_deaths)
la.plot.bar(y=['deaths', 'daily_deaths'], x='date', subplots=True)
```

```{python lines_to_next_cell=0}
daily_la_cases = np.asarray(la['cases']).copy()
daily_la_cases[1:] = daily_la_cases[1:] - daily_la_cases[:-1]
la.insert(3, 'daily_cases', daily_la_cases)
la.plot.bar(y=['cases', 'daily_cases'], subplots=True)
```
## Tennessee deaths & cases

```{python}
tn = states.loc[lambda df: df['state'] == 'Tennessee']
daily_tn_deaths = np.asarray(tn['deaths']).copy()
daily_tn_deaths[1:] = daily_tn_deaths[1:] - daily_tn_deaths[:-1]
tn.insert(3, 'daily_deaths', daily_tn_deaths)
tn.plot.bar(y=['deaths', 'daily_deaths'], x='date', subplots=True)
```

```{python lines_to_next_cell=0}
daily_tn_cases = np.asarray(tn['cases']).copy()
daily_tn_cases[1:] = daily_tn_cases[1:] - daily_tn_cases[:-1]
tn.insert(3, 'daily_cases', daily_tn_cases)
tn.plot.bar(y=['cases', 'daily_cases'], x='date', subplots=True)
```
